<!--
    Jon Doltar
    2016-01
    ESP-DLUX Client
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<!-- External styles for this element -->
<link rel="import" href="../styles/leader-board-style.html">
<link href="https://afeld.github.io/emoji-css/emoji.css" rel="stylesheet">


<dom-module id="emoji-icon">
    <!-- Include the external styles for this element -->
    <style is="custom-style">

        img {
            width: 24px;
            height: 24px;
            display: inline-block;
            position: relative;
            top: 8px;
        }

    </style>
    <template>

        <template is="dom-if" if="[[!isCustom]]">
            <span class$="em em-{{code}}"></span>
        </template>

        <template is="dom-if" if="[[isCustom]]">
            <img src$="{{code}}">
        </template>




        <content></content>
    </template>
    <script>
        (function () {
            'use strict';

            Polymer({
                is: 'emoji-icon',
                properties: {
                    // incoming icon code
                    icon: {
                        type: String
                    },
                    //computed code
                    code: {
                        type: String
                    },
                    emojiList: {
                        type: Object
                    },
                    userList: {
                        type: Array
                    },
                    isCustom: {
                        type: Boolean,
                        computed: 'processIcon(icon, emojiList)'
                    }
                },
                created: function () {

                },
                ready: function () {
                    var that = this;
                },
                processIcon: function(icon, emojiList) {
                    //check if icon exists in the custom emoji list
                    var keys = Object.keys(emojiList);

                    for(var i = 0; i< keys.length; i++) {
                        if(keys[i] === icon) {
                            var url = emojiList[keys[i]];
                            // check if this is just an alias
                            if(url.indexOf('alias') > 0) {
                                // remove alias label (first six characters)
                                this.set('code', url.substr(6));
                                return false;
                            }
                            // not an alias, set url;
                            this.set('code', url);
                            return true;
                        }
                    }
                    // icon is not custom, use emoji css library
                    this.set('code', icon);
                    return false;

                }
            });
        })();
    </script>
</dom-module>
